# Contentful Backup & Migrate

This is an interactive CLI tool that helps to create a backup of a Contentful Space. Said backup can be then resotred an applied to the same or other space.

## Installation

Since this repository is private, you can't install it directly through NPM, so just clone it to be able to use it.

## Usage

`node bin/cli.js <options>`

## Requested inputs

When creating a backup, the tool will request the following information

| Input             | Description                                                                          |
| ----------------- | ------------------------------------------------------------------------------------ |
| `spaceId`         | The Contentful Space ID to backup                                                    |
| `managementToken` | Your Contentful Management Token                                                     |
| `environmentId`   | The environment ID within the space. Defaults to `master`                            |
| `skipContent`     | Flag checking if the content should be excluded from the backup. Defaults to `false` |
| `skipRoles`       | Flag checking if roles should be excluded from the backup. Defaults to `false`       |
| `skipWebhooks`    | Flag checking if webhooks should be excluded from the backup. Defaults to `false`    |

Backups will be stored in a `contentful-backups` directory which will be located in the directory where the script is called.

After a backup is created, the tool will provide an option to migrate this backup into a new contentful space

The following inputs will be requested

| Input                   | Description                                                                                       |
| ----------------------- | ------------------------------------------------------------------------------------------------- |
| `spaceId`               | The Contentful Space ID to migrate to                                                             |
| `managementToken`       | Your Contentful Management Token                                                                  |
| `environmentId`         | The environment ID within the space. Defaults to `master`                                         |
| `backupFile`            | Path to the file containing the backup. If a backup was generated before, this will be pre-filled |
| `contentModelOnly`      | Flag checking if only the content model should be migrated. Defaults to `false`                   |
| `skipContentModel`      | Flag checking if only the content model should be excluded. Defaults to `false`                   |
| `skipLocales`           | Flag checking if locales should be excluded. Defaults to `false`                                  |
| `skipContentPublishing` | Flag checking content should be published. Defaults to `false`                                    |

> NOTE: If a backup is not generated, you'll need to manualy enter the path to a file containing a valid contentful backup generated by this tool

## Options

| Option                    | Description                                                                           |
| ------------------------- | ------------------------------------------------------------------------------------- |
| -t, --token <token>       | The contentful Management Token. Will be pre-filled for both backup and migrate steps |
| -o, --origin-spaceid <id> | SpaceID for the origin environment to backup                                          |
| -d, --dest-spaceid <id>   | SpaceID for the destination environment to migrate to                                 |
| -f --file <file>          | Existing backup to use for a new migration. Will be pre-filled in the input questions. If provided, the backup step is skipped. |
